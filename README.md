# アプリケーション概要
**[ReserveSpace](https://www.reserve-space.net/)**  

レンタルスペースの予約管理、決済代行サービスです。

# 機能

**共通**
- スペース検索
- スペース地図表示(Google Map API)

**掲載者（オーナー）**
- deviseによるログイン・ログアウト・登録・編集・削除
- スペース登録・削除・編集
- スペースの予約受付設定
  - 当日予約の可否
  - ○日後までの予約受付
  - 期間指定での予約拒否
- 予約一覧確認
- 予約検索
- 予約CSV出力
- スペースのPV確認

**利用者（ユーザー）**
- deviseによるログイン・ログアウト・登録・編集・削除
- 予約作成・キャンセル
- 予約履歴確認
- 決済,返金(Pay.jp API)
  - テストカード: 4242 4242 4242 4242
  - エラーカード: 4000 0000 0000 4012
- お気に入り登録・削除(Ajax)
- レビュー投稿・削除(Ajax)

# 詳細な機能・工夫したところ
- 404, 500エラーハンドリング(ApplicationControllerでのrescue_from)
- 郵便番号をもとに住所自動補完
- トップページ、レビュー一覧、お気に入り一覧ページの無限スクロール
- 定数の一元管理(config/initializers/constants.rb)
- 予約作成、キャンセル処理にトランザクションを使用
- 全てのスペースが削除完了しないと掲載者アカウントを削除できないようコールバックを実装
- 未完了の予約がある場合は、スペース・利用者アカウントの削除ができないようコールバックを実装
- validates_timeliness gem, validates_overlap gem を用いた時間周りのバリデーション実装
- Postgresqlの範囲関数tstzrangeを用いた日時範囲検索
- 利用したことの無いスペースへのレビュー投稿をバリデーションで防ぐ
- delegateを用いて、Spaceモデルのインスタンスから直接Settingモデルのインスタンスメソッドを呼べるよう実装
- スペース検索で利用日時と利用時間数を入れた場合、その日時に予約が入っていないスペースを表示すること、スペースの設定でその日時に予約ができない場合はそのスペースを表示しないよう実装
- ActiveSupport::Testing::TimeHelpersを用いたテスト
- 不要なテストオブジェクトを作成しない為に、全てのモデルで使用可能なtrait: :skip_validateの使用

# 使用技術

**■言語**  
Ruby 2.5.8

**■フレームワーク**  
Ruby on Rails 5.2.4.4

**■テスティングフレームワーク**  
RSpec

**■CSSフレームワーク**  
Bootstrap4

**■テンプレートエンジン**  
slim

**■リンター**  
Rubocop  
Slim-lint

**■セキュリティチェック**  
Brakeman

**■API**  
Pay.jp  
Google Map

**■CI**  
circleCI（テストのみ）

**■インフラ**  
AWS EC2  
Docker

**■データベース**  
AWS RDS  
PostgreSQL 12.3

**■ドメイン**  
AWS Route53

**■SSL/TLS証明書**  
AWS ACM

**■画像保存**  
AWS S3

**■メール**  
Gmail

**■アプリケーションサーバー**  
puma

**■webサーバー**  
nginx
